# Encrypted installer - https://github.com/rikonor/inits
$ErrorActionPreference = "Stop"
if (-not (Get-Command openssl -ErrorAction SilentlyContinue)) {
    Write-Host "Error: openssl not found." -ForegroundColor Red
    Write-Host "Please install Git for Windows: https://git-scm.com/download/win"
    Write-Host "Then run this script from Git Bash or ensure openssl is in PATH."
    exit 1
}
$Password = Read-Host -Prompt "Password" -AsSecureString
$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($Password)
$PlainPassword = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)
$Payload = "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"
$Decrypted = $Payload | openssl enc -aes-256-cbc -d -a -pbkdf2 -iter 100000 -k $PlainPassword 2>$null
if (-not $Decrypted) { Write-Host "Error: Decryption failed. Wrong password?" -ForegroundColor Red; exit 1 }
$Decrypted | Invoke-Expression
