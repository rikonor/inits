# Encrypted installer - https://github.com/rikonor/inits
$ErrorActionPreference = "Stop"
if (-not (Get-Command openssl -ErrorAction SilentlyContinue)) {
    Write-Host "Error: openssl not found." -ForegroundColor Red
    Write-Host "Please install Git for Windows: https://git-scm.com/download/win"
    Write-Host "Then run this script from Git Bash or ensure openssl is in PATH."
    exit 1
}
$Password = Read-Host -Prompt "Password" -AsSecureString
$BSTR = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($Password)
$PlainPassword = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)
$Payload = "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"
$Decrypted = $Payload | openssl enc -aes-256-cbc -d -a -pbkdf2 -iter 100000 -k $PlainPassword 2>$null
if (-not $Decrypted) { Write-Host "Error: Decryption failed. Wrong password?" -ForegroundColor Red; exit 1 }
$Decrypted | Invoke-Expression
